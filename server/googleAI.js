const {
    GoogleGenerativeAI,
    HarmCategory,
    HarmBlockThreshold,
  } = require("@google/generative-ai");
  
  const MODEL_NAME = "gemini-pro";
  const API_KEY = process.env.GOOGLEAI_KEY;
  
  async function geminiGenerateResponse(input) {
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ model: MODEL_NAME });
  
    const generationConfig = {
      temperature: 0.9,
      topK: 1,
      topP: 1,
      maxOutputTokens: 2048,
    };
  
    const safetySettings = [
      {
        category: HarmCategory.HARM_CATEGORY_HARASSMENT,
        threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
      },
      {
        category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,
        threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
      },
      {
        category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,
        threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
      },
      {
        category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,
        threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
      },
    ];

/*   const parts = [
    { text: "Simulate an official Pokemon battle. Will return the winner of the battle and the remaining HP of the winner. Remaining HP should not be greater than the provided HP. The pokemons could be the same, so provide which player has won. Use the JSON format given below. " + outputFormat},
    { text: JSON.stringify(input) },  // Add the new input JSON here
  ]; */

  const parts = [
    {text: "Pokemon battle based on stats. Will return the winner of the battle and the remaining HP in JSON format. Remaining HP should not be greater than the provided HP."},
    {text: "Simulate an official Pokemon battle. Will return the winner of the battle and the battle log. It must be used the stats given in this prompt. The HP to be fainted is 0 and the total damage should not be greater than the provided HP in stats. Remaining HP must match the provided HP minus HP lost in the battle log. The pokemons could be the same, so provide which player has won. \nThis is a 1v1 battle and others pokemon could not be used.\nThe return is a JSON format given below. \n{\n \"winner\": \"b\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"a's Dragalge used Draco Meteor.\",\n   \"pokemon1HPLost\": -30,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 30 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"b's Zamazenta used Metal Claw.\",\n   \"pokemon1HPLost\": -40,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 40 HP.\"\n  },\n  {\n   \"turn\": 3,\n   \"action\": \"a's Dragalge used Sludge Bomb.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Zamazenta lost 50 HP.\"\n  },\n  {\n   \"turn\": 4,\n   \"action\": \"b's Zamazenta used Close Combat.\",\n   \"pokemon1HPLost\": -80,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 80 HP.\"\n  },\n  {\n   \"turn\": 5,\n   \"action\": \"a's Dragalge used Poison Tail.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Zamazenta lost 30 HP.\"\n  },\n  {\n   \"turn\": 6,\n   \"action\": \"b's Zamazenta used Iron Head.\",\n   \"pokemon1HPLost\": -60,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 60 HP.\"\n  },\n  {\n   \"turn\": 7,\n   \"action\": \"a's Dragalge used Acid Spray.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -10,\n   \"result\": \"Zamazenta lost 10 HP and its Defense stat was lowered.\"\n  },\n  {\n   \"turn\": 8,\n   \"action\": \"b's Zamazenta used Double-Edge.\",\n   \"pokemon1HPLost\": -50,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 50 HP and Zamazenta lost 25 HP due to recoil.\"\n  },\n  {\n   \"turn\": 9,\n   \"action\": \"a's Dragalge used Dragon Pulse.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Zamazenta lost 40 HP.\"\n  },\n  {\n   \"turn\": 10,\n   \"action\": \"b's Zamazenta used High Horsepower.\",\n   \"pokemon1HPLost\": -70,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 70 HP.\"\n  },\n  {\n   \"turn\": 11,\n   \"action\": \"a's Dragalge fainted.\",\n   \"pokemon1HPLost\": -11,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 11 HP and fainted.\"\n  }\n ]\n}"},
    {text: "{\"pokemon1\":{\"trainer\":\"a\",\"name\":\"dragalge\",\"type\":\"Poison/Dragon\",\"level\":50,\"stats\":{\"hp\":161,\"attack\":85,\"defense\":121,\"special-attack\":118,\"special-defense\":136,\"speed\":62}},\"pokemon2\":{\"trainer\":\"b\",\"name\":\"zamazenta\",\"type\":\"Fighting\",\"level\":50,\"stats\":{\"hp\":198,\"attack\":144,\"defense\":124,\"special-attack\":92,\"special-defense\":127,\"speed\":155}}}"},
    {text: "{\n \"winner\": \"b\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"a's Dragalge used Draco Meteor.\",\n   \"pokemon1HPLost\": -30,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 30 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"b's Zamazenta used Metal Claw.\",\n   \"pokemon1HPLost\": -40,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 40 HP.\"\n  },\n  {\n   \"turn\": 3,\n   \"action\": \"a's Dragalge used Sludge Bomb.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Zamazenta lost 50 HP.\"\n  },\n  {\n   \"turn\": 4,\n   \"action\": \"b's Zamazenta used Close Combat.\",\n   \"pokemon1HPLost\": -80,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 80 HP.\"\n  },\n  {\n   \"turn\": 5,\n   \"action\": \"a's Dragalge used Poison Tail.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Zamazenta lost 30 HP.\"\n  },\n  {\n   \"turn\": 6,\n   \"action\": \"b's Zamazenta used Iron Head.\",\n   \"pokemon1HPLost\": -60,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 60 HP.\"\n  },\n  {\n   \"turn\": 7,\n   \"action\": \"a's Dragalge used Acid Spray.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -10,\n   \"result\": \"Zamazenta lost 10 HP and its Defense stat was lowered.\"\n  },\n  {\n   \"turn\": 8,\n   \"action\": \"b's Zamazenta used Double-Edge.\",\n   \"pokemon1HPLost\": -50,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 50 HP and Zamazenta lost 25 HP due to recoil.\"\n  },\n  {\n   \"turn\": 9,\n   \"action\": \"a's Dragalge used Dragon Pulse.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Zamazenta lost 40 HP.\"\n  },\n  {\n   \"turn\": 10,\n   \"action\": \"b's Zamazenta used High Horsepower.\",\n   \"pokemon1HPLost\": -70,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 70 HP.\"\n  },\n  {\n   \"turn\": 11,\n   \"action\": \"a's Dragalge fainted.\",\n   \"pokemon1HPLost\": -11,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 11 HP and fainted.\"\n  }\n ]\n}"},
    {text: "Simulate an official Pokemon battle. Will return the winner of the battle and the battle log. It must be used the stats given in this prompt. The HP to be fainted is 0 and the total damage should not be greater than the provided HP in stats. Remaining HP must match the provided HP minus HP lost in the battle log. The pokemons could be the same, so provide which player has won. \nThis is a 1v1 battle and others pokemon could not be used.\nThe return is a JSON format given below. \n{\n \"winner\": \"Nelson\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"Nelson's Bellossom used Razor Leaf.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -20,\n   \"result\": \"Shuppet lost 20 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"Gabriel's Shuppet used Shadow Sneak.\",\n   \"pokemon1HPLost\": -30,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 30 HP.\"\n  },\n  {\n   \"turn\": 3,\n   \"action\": \"Nelson's Bellossom used Solar Beam.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Shuppet lost 40 HP.\"\n  },\n  {\n   \"turn\": 4,\n   \"action\": \"Gabriel's Shuppet used Confuse Ray.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom is now confused.\"\n  },\n  {\n   \"turn\": 5,\n   \"action\": \"Bellossom used Petal Dance in its confusion.\",\n   \"pokemon1HPLost\": -20,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 20 HP.\"\n  },\n  {\n   \"turn\": 6,\n   \"action\": \"Nelson's Bellossom used Giga Drain.\",\n   \"pokemon1HPLost\": 30,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Bellossom regained 30 HP. Shuppet lost 30 HP.\"\n  },\n  {\n   \"turn\": 7,\n   \"action\": \"Gabriel's Shuppet used Shadow Claw.\",\n   \"pokemon1HPLost\": -25,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 25 HP.\"\n  },\n  {\n   \"turn\": 8,\n   \"action\": \"Nelson's Bellossom used Sleep Powder.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet is now asleep.\"\n  },\n  {\n   \"turn\": 9,\n   \"action\": \"Nelson's Bellossom used Petal Blizzard.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -45,\n   \"result\": \"Shuppet lost 45 HP.\"\n  },\n  {\n   \"turn\": 10,\n   \"action\": \"Shuppet woke up.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet is no longer asleep.\"\n  },\n  {\n   \"turn\": 11,\n   \"action\": \"Gabriel's Shuppet used Curse.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet's attack and defense increased, but its speed decreased.\"\n  },\n  {\n   \"turn\": 12,\n   \"action\": \"Nelson's Bellossom used Sunny Day.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"The sunlight intensified, boosting Bellossom's Solar Beam power.\"\n  },\n  {\n   \"turn\": 13,\n   \"action\": \"Nelson's Bellossom used Solar Beam.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Shuppet lost 50 HP and fainted.\"\n  }\n ]\n}"},
    {text: "{\"pokemon1\":{\"trainer\":\"Nelson\",\"name\":\"bellossom\",\"type\":\"Grass\",\"level\":50,\"stats\":{\"hp\":200,\"attack\":100,\"defense\":131,\"special-attack\":105,\"special-defense\":118,\"speed\":72}},\"pokemon2\":{\"trainer\":\"Gabriel\",\"name\":\"shuppet\",\"type\":\"Ghost\",\"level\":50,\"stats\":{\"hp\":141,\"attack\":88,\"defense\":49,\"special-attack\":73,\"special-defense\":43,\"speed\":63}}}"},
    {text: "{\n \"winner\": \"Nelson\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"Nelson's Bellossom used Razor Leaf.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -20,\n   \"result\": \"Shuppet lost 20 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"Gabriel's Shuppet used Shadow Sneak.\",\n   \"pokemon1HPLost\": -30,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 30 HP.\"\n  },\n  {\n   \"turn\": 3,\n   \"action\": \"Nelson's Bellossom used Solar Beam.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Shuppet lost 40 HP.\"\n  },\n  {\n   \"turn\": 4,\n   \"action\": \"Gabriel's Shuppet used Confuse Ray.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom is now confused.\"\n  },\n  {\n   \"turn\": 5,\n   \"action\": \"Bellossom used Petal Dance in its confusion.\",\n   \"pokemon1HPLost\": -20,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 20 HP.\"\n  },\n  {\n   \"turn\": 6,\n   \"action\": \"Nelson's Bellossom used Giga Drain.\",\n   \"pokemon1HPLost\": 30,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Bellossom regained 30 HP. Shuppet lost 30 HP.\"\n  },\n  {\n   \"turn\": 7,\n   \"action\": \"Gabriel's Shuppet used Shadow Claw.\",\n   \"pokemon1HPLost\": -25,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Bellossom lost 25 HP.\"\n  },\n  {\n   \"turn\": 8,\n   \"action\": \"Nelson's Bellossom used Sleep Powder.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet is now asleep.\"\n  },\n  {\n   \"turn\": 9,\n   \"action\": \"Nelson's Bellossom used Petal Blizzard.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -45,\n   \"result\": \"Shuppet lost 45 HP.\"\n  },\n  {\n   \"turn\": 10,\n   \"action\": \"Shuppet woke up.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet is no longer asleep.\"\n  },\n  {\n   \"turn\": 11,\n   \"action\": \"Gabriel's Shuppet used Curse.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Shuppet's attack and defense increased, but its speed decreased.\"\n  },\n  {\n   \"turn\": 12,\n   \"action\": \"Nelson's Bellossom used Sunny Day.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"The sunlight intensified, boosting Bellossom's Solar Beam power.\"\n  },\n  {\n   \"turn\": 13,\n   \"action\": \"Nelson's Bellossom used Solar Beam.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Shuppet lost 50 HP and fainted.\"\n  }\n ]\n}"},
    {text: "Simulate an official Pokemon battle. Will return the winner of the battle and the battle log. It must be used the stats given in this prompt. The HP to be fainted is 0 and the total damage should not be greater than the provided HP in stats. Remaining HP must match the provided HP minus HP lost in the battle log. The pokemons could be the same, so provide which player has won. \nThis is a 1v1 battle and others pokemon could not be used.\nThe last turn is the turn a pokemon fainted.\nCritical hits should be considered.\nFirst pokemon to attack is the one who have the highest speed.\nThe attacker should use its attack and special attack stats.\nThe defender should use its defense and special defense stats.\nThe return is a JSON exemple format given below. \n{\n \"winner\": \"b\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"\"\n  },\n..., // other turns\n{\n   \"turn\": 99,\n   \"action\": \"\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"\"\n}\n  \n ]\n}"},
    {text: "{\"pokemon1\":{\"trainer\":\"a\",\"name\":\"dragalge\",\"type\":\"Poison/Dragon\",\"level\":50,\"stats\":{\"hp\":161,\"attack\":85,\"defense\":121,\"special-attack\":118,\"special-defense\":136,\"speed\":62}},\"pokemon2\":{\"trainer\":\"b\",\"name\":\"zamazenta\",\"type\":\"Fighting\",\"level\":50,\"stats\":{\"hp\":198,\"attack\":144,\"defense\":124,\"special-attack\":92,\"special-defense\":127,\"speed\":155}}}"},
    {text: "{\n \"winner\": \"b\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"Dragalge used Draco Meteor.\",\n   \"pokemon1HPLost\": -30,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Zamazenta lost 30 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"Zamazenta used Metal Claw.\",\n   \"pokemon1HPLost\": -40,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 40 HP.\"\n  },\n  {\n   \"turn\": 3,\n   \"action\": \"Dragalge used Sludge Bomb.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Zamazenta lost 50 HP.\"\n  },\n  {\n   \"turn\": 4,\n   \"action\": \"Zamazenta used Close Combat.\",\n   \"pokemon1HPLost\": -80,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 80 HP.\"\n  },\n  {\n   \"turn\": 5,\n   \"action\": \"Dragalge used Poison Tail.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Zamazenta lost 30 HP.\"\n  },\n  {\n   \"turn\": 6,\n   \"action\": \"Zamazenta used Iron Head.\",\n   \"pokemon1HPLost\": -60,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 60 HP.\"\n  },\n  {\n   \"turn\": 7,\n   \"action\": \"Dragalge used Acid Spray.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -10,\n   \"result\": \"Zamazenta lost 10 HP.\"\n  },\n  {\n   \"turn\": 8,\n   \"action\": \"Zamazenta used Double-Edge.\",\n   \"pokemon1HPLost\": -50,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 50 HP and Zamazenta lost 25 HP due to recoil.\"\n  },\n  {\n   \"turn\": 9,\n   \"action\": \"Dragalge used Dragon Pulse.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Zamazenta lost 40 HP.\"\n  },\n  {\n   \"turn\": 10,\n   \"action\": \"Zamazenta used Crunch.\",\n   \"pokemon1HPLost\": -80,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 80 HP.\"\n  },\n  {\n   \"turn\": 11,\n   \"action\": \"Dragalge used Draco Meteor.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -30,\n   \"result\": \"Zamazenta lost 30 HP.\"\n  },\n  {\n   \"turn\": 12,\n   \"action\": \"Zamazenta used Metal Claw.\",\n   \"pokemon1HPLost\": -40,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 40 HP.\"\n  },\n  {\n   \"turn\": 13,\n   \"action\": \"Dragalge used Sludge Bomb.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -50,\n   \"result\": \"Zamazenta lost 50 HP.\"\n  },\n  {\n   \"turn\": 14,\n   \"action\": \"Zamazenta used Close Combat.\",\n   \"pokemon1HPLost\": -80,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 80 HP.\"\n  },\n  {\n   \"turn\": 15,\n   \"action\": \"Dragalge fainted.\",\n   \"pokemon1HPLost\": -11,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Dragalge lost 11 HP and fainted.\"\n  }\n ]\n}"},
    {text: "Simulate an official Pokemon battle. Will return the winner of the battle and the battle log. It must be used the stats given in this prompt. The HP to be fainted is 0 and the total damage should not be greater than the provided HP in stats. Remaining HP must match the provided HP minus HP lost in the battle log. The pokemons could be the same, so provide which player has won. \nThis is a 1v1 battle and others pokemon could not be used.\nThe last turn is the turn a pokemon fainted.\nCritical hits should be considered.\nFirst pokemon to attack is the one who have the highest speed.\nThe attacker should use its attack and special attack stats.\nThe defender should use its defense and special defense stats.\nThe return is a JSON exemple format given below. \n{\n \"winner\": \"b\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"\"\n  },\n..., // other turns\n{\n   \"turn\": 99,\n   \"action\": \"\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"\"\n}\n  \n ]\n}"},
    {text: "{\"pokemon1\":{\"trainer\":\"a\",\"name\":\"dragalge\",\"type\":\"Poison/Dragon\",\"level\":50,\"stats\":{\"hp\":161,\"attack\":85,\"defense\":121,\"special-attack\":118,\"special-defense\":136,\"speed\":62}},\"pokemon2\":{\"trainer\":\"b\",\"name\":\"zamazenta\",\"type\":\"Fighting\",\"level\":50,\"stats\":{\"hp\":10,\"attack\":144,\"defense\":124,\"special-attack\":92,\"special-defense\":127,\"speed\":155}}}"},
    {text: "{\n \"winner\": \"a\",\n \"battleLog\": [\n  {\n   \"turn\": 1,\n   \"action\": \"Zamazenta used Metal Claw.\",\n   \"pokemon1HPLost\": 0,\n   \"pokemon2HPLost\": -40,\n   \"result\": \"Dragalge lost 40 HP.\"\n  },\n  {\n   \"turn\": 2,\n   \"action\": \"Dragalge used Draco Meteor.\",\n   \"pokemon1HPLost\": -10,\n   \"pokemon2HPLost\": 0,\n   \"result\": \"Zamazenta lost 10 HP.\"\n  }\n ]\n}"},
    {text: JSON.stringify(input)},
  ];

  const result = await model.generateContent({
    contents: [{ role: "user", parts }],
    generationConfig,
    safetySettings,
  });

  const response = result.response;

  return response.text() 
  }
  
  module.exports = { geminiGenerateResponse };